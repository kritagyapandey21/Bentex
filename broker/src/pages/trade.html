<!-- Trade Page Content -->
<div class="glass-panel p-4 flex flex-col gap-2 mb-2">
  <div class="flex items-center justify-between text-xs text-gray-400">
    <span>Logged in as <span id="currentUserEmail" class="text-[var(--color-text-primary)] font-semibold">â€”</span></span>
    <span class="hidden sm:inline-flex items-center gap-1 text-[10px] tracking-wide uppercase text-[var(--color-text-muted)]">
      <i class="fas fa-shield-alt text-[var(--color-action-accent)]"></i>
      Session Secure
    </span>
  </div>
  <div class="w-full flex items-center justify-between top-chart-controls">
    <div class="flex items-center gap-2">
      <label style="color:#8493b8;" class="text-sm">Asset:</label>
      <select id="currentAssetSelector" class="glass-select cursor-pointer" style="min-width:220px;"></select>
      
      <!-- Chart Type dropdown -->
      <div class="relative z-[100000]">
        <button id="chartTypeDropdownBtn" class="chart-option-btn flex items-center gap-1">
          <i class="fas fa-chart-candlestick"></i>
          <span id="chartTypeLabel">Candlestick</span>
          <i class="fas fa-chevron-down text-xs"></i>
        </button>
        <div id="chartTypeDropdown" class="hidden glass-panel rounded-md shadow-lg min-w-[200px]">
          <div class="py-1">
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 border-b border-gray-700 flex items-center justify-between">
              <span>Chart Type</span>
              <button class="close-chart-type-btn hover:bg-red-500/20 rounded p-1" title="Close">
                <i class="fas fa-times text-gray-400 hover:text-red-400"></i>
              </button>
            </div>
            <button data-chart-type="candles" class="chart-type-option w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-candlestick mr-2"></i>Candlestick</span>
              <i class="fas fa-check text-[var(--neon-cyan)] chart-type-check"></i>
            </button>
            <button data-chart-type="line" class="chart-type-option w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-line mr-2"></i>Line</span>
              <i class="fas fa-check text-[var(--neon-cyan)] chart-type-check" style="display: none;"></i>
            </button>
            <button data-chart-type="area" class="chart-type-option w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-area mr-2"></i>Area</span>
              <i class="fas fa-check text-[var(--neon-cyan)] chart-type-check" style="display: none;"></i>
            </button>
            <button data-chart-type="bars" class="chart-type-option w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-bar mr-2"></i>Bars</span>
              <i class="fas fa-check text-[var(--neon-cyan)] chart-type-check" style="display: none;"></i>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Indicators dropdown -->
      <div class="relative z-[100000]">
        <button id="indicatorsDropdownBtn" class="chart-option-btn flex items-center gap-1">
          <i class="fas fa-sliders-h"></i>
          <span>Indicators</span>
          <i class="fas fa-chevron-down text-xs"></i>
        </button>
        <div id="indicatorsDropdown" class="hidden glass-panel rounded-md shadow-lg min-w-[220px]">
          <div class="py-1">
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 border-b border-gray-700 flex items-center justify-between">
              <span>Trend Indicators</span>
              <button class="close-dropdown-btn hover:bg-red-500/20 rounded p-1" title="Close">
                <i class="fas fa-times text-gray-400 hover:text-red-400"></i>
              </button>
            </div>
            <button id="toggleMAIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-line mr-2"></i>Moving Averages</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check"></i>
            </button>
            <button id="toggleEMAIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-wave-square mr-2"></i>EMA</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            <button id="toggleBollingerIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-arrows-alt-v mr-2"></i>Bollinger Bands</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 border-b border-t border-gray-700">Momentum Indicators</div>
            <button id="toggleRSIIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-tachometer-alt mr-2"></i>RSI</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            <button id="toggleMACDIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-signal mr-2"></i>MACD</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            <button id="toggleStochasticIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-area mr-2"></i>Stochastic</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 border-b border-t border-gray-700">Volume Indicators</div>
            <button id="toggleVolumeIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-chart-bar mr-2"></i>Volume</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check"></i>
            </button>
            <button id="toggleOBVIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-layer-group mr-2"></i>OBV</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
            
            <div class="px-3 py-2 text-xs font-semibold text-gray-400 border-b border-t border-gray-700">Volatility Indicators</div>
            <button id="toggleATRIndicator" class="w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-[rgba(255,255,255,0.1)] flex items-center justify-between">
              <span><i class="fas fa-burn mr-2"></i>ATR</span>
              <i class="fas fa-check text-[var(--neon-cyan)] indicator-check" style="display: none;"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="flex items-center gap-4">
    <div class="flex items-center gap-4">
      <div class="text-base font-semibold text-white" id="currentAssetName">EUR/USD</div>
      <div class="text-base font-semibold text-[var(--neon-green)]" id="currentAssetPrice">1.08542</div>
      <div class="text-sm font-medium px-2 py-1 rounded-md bg-green-900/50 text-[var(--neon-green)]" id="currentAssetChange">+0.12%</div>
    </div>
    <div class="flex items-center gap-2 ml-auto">
      <div class="hidden lg:flex items-center gap-2">
        <div class="bg-green-900/50 text-[var(--neon-green)] text-xs font-medium px-3 py-1.5 rounded-md">Payout: <span id="payoutPercent">95%</span></div>
        <div class="glass-panel text-gray-400 text-xs font-medium px-3 py-1.5 rounded-md">Demo Account</div>
      </div>
      <!-- Timeframe buttons -->
      <div class="flex items-center gap-1">
        <button class="timeframe-btn chart-option-btn" data-timeframe="30s">30s</button>
        <button class="timeframe-btn chart-option-btn active-btn" data-timeframe="1m">1m</button>
        <button class="timeframe-btn chart-option-btn" data-timeframe="5m">5m</button>
        <button class="timeframe-btn chart-option-btn" data-timeframe="15m">15m</button>
        <button class="timeframe-btn chart-option-btn" data-timeframe="30m">30m</button>
        <button class="timeframe-btn chart-option-btn hidden sm:inline" data-timeframe="1h">1h</button>
      </div>
    </div>
  </div>
</div>

<div class="flex-1 flex flex-row overflow-hidden gap-2">
  <!-- Asset Selection Panel -->
  <div id="asset-selection-column" class="w-72 glass-panel flex-col p-4 overflow-y-auto hidden">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-white">Select Asset</h2>
      <button class="close-dropdown-btn" id="closeAssetPanel" title="Close">
        <i class="fas fa-times text-gray-400 hover:text-red-400"></i>
      </button>
    </div>
    <div class="flex mb-4 border-b border-[var(--glass-border)]">
      <button class="asset-tab-btn active-tab flex-1 text-sm font-medium" data-asset-tab="forex">Forex</button>
      <button class="asset-tab-btn flex-1 text-sm font-medium" data-asset-tab="otc">OTC</button>
      <button class="asset-tab-btn flex-1 text-sm font-medium" data-asset-tab="crypto">Crypto</button>
    </div>
    <div id="asset-tab-content-forex" class="asset-tab-content grid grid-cols-1 gap-2"></div>
    <div id="asset-tab-content-otc" class="asset-tab-content hidden grid grid-cols-1 gap-2"></div>
    <div id="asset-tab-content-crypto" class="asset-tab-content hidden grid grid-cols-1 gap-2"></div>
  </div>

  <!-- Chart Area -->
  <div class="flex-1 flex flex-col gap-2 overflow-hidden">
    <div class="chart-container flex-1 glass-panel" id="tv-chart-container" style="position: relative; min-height: 400px;">
      <div id="chart-area" style="position: relative; width: 100%; height: 100%;">
        <div id="price-chart" style="position: relative; width: 100%; height: 100%;"></div>
        <select id="chart-asset-selector" style="position:absolute;top:10px;left:10px;display:none;"></select>
        <div id="crosshair-tooltip"></div>
        
        <!-- Fullscreen Toggle Button -->
        <button id="btn-fullscreen-toggle" class="fullscreen-toggle-btn" title="Fullscreen">
          <i class="fas fa-expand"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Trading Panel -->
  <div class="w-80 glass-panel p-4 flex flex-col gap-4 overflow-y-auto">
    <div>
      <div class="text-sm font-medium text-gray-300 mb-2">Investment Amount</div>
      <div class="flex gap-2 mb-2">
        <button class="amount-option control-btn active-btn flex-1" data-amount="10">$10</button>
        <button class="amount-option control-btn flex-1" data-amount="50">$50</button>
        <button class="amount-option control-btn flex-1" data-amount="100">$100</button>
        <button class="amount-option control-btn flex-1" data-amount="500">$500</button>
      </div>
      <div class="flex gap-2">
        <input type="number" id="investmentAmount" class="flex-1 glass-input" value="10" min="1" step="1">
        <button id="decreaseAmount" class="control-btn w-10 h-10 flex items-center justify-center">-</button>
        <button id="increaseAmount" class="control-btn w-10 h-10 flex items-center justify-center">+</button>
      </div>
    </div>

    <div>
      <div class="text-sm font-medium text-gray-300 mb-2">Expiration Time</div>
      <div class="flex gap-2">
        <button class="expiration-time control-btn active-btn flex-1">1m</button>
        <button class="expiration-time control-btn flex-1">5m</button>
        <button class="expiration-time control-btn flex-1">15m</button>
      </div>
    </div>

    <div class="glass-panel p-3 bg-[rgba(0,0,0,0.1)]">
      <div class="flex justify-between text-sm mb-1">
        <span class="text-gray-400">Potential Payout:</span>
        <span class="text-[var(--neon-green)] font-semibold" id="potentialWin">$19.50</span>
      </div>
      <div class="flex justify-between text-sm">
        <span class="text-gray-400">Multiplier:</span>
        <span class="text-white font-semibold" id="multiplierValue">x1.95</span>
      </div>
    </div>

    <div class="flex gap-2">
      <button id="buyButton" class="flex-1 btn-glow btn-glow-buy">CALL</button>
      <button id="sellButton" class="flex-1 btn-glow btn-glow-sell">PUT</button>
    </div>

    <div class="glass-panel p-4 mt-3">
      <div class="flex justify-between items-center text-sm font-medium text-gray-300 mb-2">
        <span>Active Trades</span>
        <span id="activeTradesCount">0</span>
      </div>
      <div class="max-h-[180px] overflow-y-auto" id="activeTradesList">
        <div class="text-center py-8 text-gray-500 text-sm">No active trades</div>
      </div>
    </div>
  </div>
</div>
